---
import BaseLayout from './BaseLayout.astro';
import Header from '@/components/layout/Header.astro';
import Footer from '@/components/layout/Footer.astro';
import Icon from '@/components/common/Icon.astro';

interface Props {
  title: string;
  description: string;
  pubDate: Date;
  updatedDate?: Date;
  heroImage?: string;
  tags?: string[];
}

const { title, description, pubDate, updatedDate, heroImage, tags = [] } = Astro.props;

function formatDate(date: Date): string {
  return date.toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
  });
}
---

<BaseLayout title={`${title} | João Paulo Santos`} description={description}>
  <Header />

  <main id="main-content" class="pt-24 pb-16" tabindex="-1">
    <article class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
      <!-- Header -->
      <header class="mb-12">
        <div class="flex flex-wrap gap-2 mb-4">
          {tags.map((tag) => (
            <span class="px-3 py-1 text-xs font-medium bg-[rgb(var(--color-accent)/0.1)] text-[rgb(var(--color-accent))] rounded-full">
              {tag}
            </span>
          ))}
        </div>

        <h1 class="text-4xl sm:text-5xl font-bold mb-4">{title}</h1>

        <p class="text-lg text-[rgb(var(--color-text-secondary))] mb-6">
          {description}
        </p>

        <div class="flex items-center gap-4 text-sm text-[rgb(var(--color-text-muted))]">
          <time datetime={pubDate.toISOString()} class="flex items-center gap-1.5">
            <Icon name="calendar" size={14} />
            {formatDate(pubDate)}
          </time>
          {updatedDate && (
            <>
              <span>•</span>
              <span>Updated: {formatDate(updatedDate)}</span>
            </>
          )}
        </div>
      </header>

      <!-- Hero Image -->
      {heroImage && (
        <div class="mb-12 rounded-2xl overflow-hidden shadow-lg">
          <img
            src={heroImage}
            alt={title}
            class="w-full h-auto"
            loading="lazy"
            decoding="async"
          />
        </div>
      )}

      <!-- Content -->
      <div class="prose prose-lg dark:prose-invert max-w-none">
        <slot />
      </div>

      <!-- Back to blog -->
      <div class="mt-16 pt-8 border-t border-[rgb(var(--color-border))]">
        <a
          href="/blog"
          class="inline-flex items-center gap-2 text-[rgb(var(--color-accent))] hover:underline group"
        >
          <span class="group-hover:-translate-x-1 transition-transform">
            <Icon name="arrow-down" size={16} class="rotate-90" />
          </span>
          Back to all posts
        </a>
      </div>
    </article>
  </main>

  <Footer />
</BaseLayout>
